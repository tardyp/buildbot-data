(function(){var t;t=function(){function t(){return[]}return t}(),angular.module("bbData",new t)}).call(this),function(){var t;t=function(){function t(t){t.useApplyAsync(!0),t.interceptors.push(["$log","API",function(t,e){return{request:function(n){return 0===n.url.indexOf(e)&&t.debug(n.method+" "+n.url),n}}}])}return t}(),angular.module("bbData").config(["$httpProvider",t])}.call(this),function(){var t;t=function(){function t(){return"api/v2/"}return t}(),angular.module("bbData").constant("API",t())}.call(this),function(){var t;t=function(){function t(){return{FIELDTYPES:{IDENTIFIER:"i",NUMBER:"n"},builds:{id:"buildid",fields:["buildid","builderid","buildrequestid","buildslaveid","complete","complete_at","masterid","number","results","started_at","state_string"],root:!0,paths:["changes","properties","steps","steps/i:name","steps/i:name/logs","steps/i:name/logs/i:slug","steps/i:name/logs/i:slug/contents","steps/i:name/logs/i:slug/raw","steps/n:number","steps/n:number/logs","steps/n:number/logs/i:slug","steps/n:number/logs/i:slug/contents","steps/n:number/logs/i:slug/raw"],"static":{complete:!0}},builders:{id:"builderid",identifier:"name",fields:["builderid","description","name","tags"],root:!0,paths:["forceschedulers","buildrequests","masters","masters/n:masterid","buildslaves","buildslaves/i:name","buildslaves/n:buildslaveid","builds","builds/n:number","builds/n:number/steps","builds/n:number/steps/i:name","builds/n:number/steps/i:name/logs","builds/n:number/steps/i:name/logs/i:slug","builds/n:number/steps/i:name/logs/i:slug/contents","builds/n:number/steps/i:name/logs/i:slug/raw","builds/n:number/steps/n:number","builds/n:number/steps/n:number/logs","builds/n:number/steps/n:number/logs/i:slug","builds/n:number/steps/n:number/logs/i:slug/contents","builds/n:number/steps/n:number/logs/i:slug/raw"],"static":!0},buildrequests:{id:"buildrequestid",fields:["buildrequestid","builderid","buildsetid","claimed","claimed_at","claimed_by_masterid","complete","complete_at","priority","results","submitted_at","waited_for"],root:!0,paths:["builds"],"static":{complete:!0}},buildsets:{id:"bsid",fields:["bsid","complete","complete_at","external_idstring","parent_buildid","parent_relationship","reason","results","sourcestamps","submitted_at"],root:!0,paths:["properties"],"static":{complete:!0}},buildslaves:{id:"buildslaveid",fields:["buildslaveid","configured_on","connected_to","name","slaveinfo"],root:!0,paths:[],"static":!0},changes:{id:"changeid",fields:["changeid","author","branch","category","codebase","comments","files","parent_changeids","project","properties","repository","revision","revlink","sourcestamp","when_timestamp"],root:!0,paths:[],"static":!0},changesources:{id:"changesourceid",fields:["changesourceid","master","name"],root:!0,paths:[],"static":!0},forceschedulers:{id:"name",fields:["name","all_fields","builder_names","label"],root:!0,paths:[],"static":!0},masters:{id:"masterid",fields:["masterid","active","last_active","name"],root:!0,paths:["builders","builders/n:builderid","builders/n:builderid/buildslaves","builders/n:builderid/buildslaves/n:buildslaveid","builders/n:builderid/buildslaves/i:name","buildslaves","buildslaves/i:name","buildslaves/n:buildslaveid","changesources","changesources/n:changesourceid","schedulers","schedulers/n:schedulerid"],"static":!0},schedulers:{id:"schedulerid",fields:["schedulerid","master","name"],root:!0,paths:[],"static":!0},sourcestamps:{id:"ssid",fields:["ssid","branch","codebase","created_at","patch","project","repository","revision"],root:!0,paths:["changes"],"static":!0},steps:{id:"stepid",identifier:"name",fields:["stepid","buildid","complete","complete_at","hidden","name","number","results","started_at","state_string","urls"],root:!1,paths:["logs","logs/i:slug","logs/i:slug/contents","logs/i:slug/raw"],"static":{complete:!0}},logs:{id:"logid",identifier:"slug",fields:["logid","complete","name","num_lines","slug","stepid","type"],root:!1,paths:[],"static":{complete:!0}},properties:{id:null,fields:[],root:!1}}}return t}(),angular.module("bbData").constant("SPECIFICATION",t())}.call(this),function(){var t,e=[].slice;t=function(){function t(){n={cache:this.cache}}var n;return t.prototype.cache=!0,n=null,t.prototype.$get=function(t,r,i,o,s,u,a,l,c,p){var f;return new(f=function(){function t(){var t;i=this,angular.extend(this,n),t=Object.keys(p).filter(function(t){return p[t].root}),this.constructor.generateEndpoints(t)}var i;return i=null,t.prototype.clearCache=function(){return c.clear().then(function(){return r.has("$state")?r.get("$state").reload():r.has("$route")?r.get("$route").reload():o.location.reload()})},t.prototype.get=function(){var t,n,r,i,o;return t=1<=arguments.length?e.call(arguments,0):[],i=this.processArguments(t),o=i[0],r=i[1],null==r.subscribe&&(r.subscribe=!1),n=this.createCollection(o,r),n.subscribe()},t.prototype.createCollection=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],function(t,e,n){n.prototype=t.prototype;var r=new n,i=t.apply(r,e);return Object(i)===i?i:r}(s,t,function(){})},t.prototype.processArguments=function(t){var e,n,r;return t.filter(function(t){return null!=t}),e=t[t.length-1],angular.isObject(e)&&(n=t.pop()),r=a.restPath(t),[r,n||{}]},t.prototype.control=function(t,e,n){return null==n&&(n={}),null==this.jsonrpc&&(this.jsonrpc=1),u.post(t,{id:this.jsonrpc++,jsonrpc:"2.0",method:e,params:n})},t.generateEndpoints=function(t){return t.forEach(function(t){return function(n){var r;return r=a.capitalize(n),t.prototype["get"+r]=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],i.get.apply(i,[n].concat(e.call(t)))}}}(this))},t.prototype.open=function(t){var n;return new(n=function(){function n(){var e;this.collections=r,e=Object.keys(p).filter(function(t){return p[t].root}),this.constructor.generateEndpoints(e),null!=t&&this.closeOnDestroy(t)}var r;return r=[],n.prototype.close=function(){return r.forEach(function(t){return"function"==typeof t.unsubscribe?t.unsubscribe():void 0})},n.prototype.closeOnDestroy=function(t){if(!angular.isFunction(t.$on))throw new Error("Parameter 'scope' doesn't have an $on function");return t.$on("$destroy",function(t){return function(){return t.close()}}(this))},n.generateEndpoints=function(t){return t.forEach(function(t){return function(n){var o;return o=a.capitalize(n),t.prototype["get"+o]=function(){var t,n,s;return t=1<=arguments.length?e.call(arguments,0):[],n=t[t.length-1],angular.isObject(n)?null==n.subscribe&&(n.subscribe=!0):t.push({subscribe:!0}),s=i["get"+o].apply(i,t),r.push(s.getArray()),s}}}(this))},n}())},t}())},t.prototype.$get.$inject=["$log","$injector","$q","$window","Collection","restService","dataUtilsService","tabexService","indexedDBService","SPECIFICATION"],t}(),angular.module("bbData").provider("dataService",[t])}.call(this),function(){var t;t=function(){function t(){return{paths:"&[path+query],path,query,lastActive"}}return t}(),angular.module("bbData").constant("DBSTORES",t())}.call(this),function(){var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},n=[].slice;t=function(){function t(t,r,i,o,s,u,a){var l;return new(l=function(){function r(){var e;this.db=new o.Dexie("BBCache"),e={},angular.extend(e,this.processSpecification(a),u),this.db.version(1).stores(e),this.db.on("error",function(e){return t.error(e)}),this.open()}return r.prototype.open=function(){return i(function(e){return function(n){return e.db.open()["catch"](function(e){return t.error("indexedDBService: open",e)})["finally"](function(){return n()})}}(this))},r.prototype.clear=function(){return i(function(e){return function(n){return e.db["delete"]()["catch"](function(e){return t.error("indexedDBService: clear",e)})["finally"](function(){return e.open().then(function(){return n()})})}}(this))},r.prototype.get=function(t,e){var n,r,o,s,u;return null==e&&(e={}),o=this.processUrl(t),u=o[0],r=o[1],n=o[2],angular.extend(e,r),null==a[u]?i.resolve([]):(s=this.db[u],this.db.transaction("r",s,function(t){return function(){return null!=n?i.resolve(s.get(n)):i(function(n,r){return s.toArray().then(function(r){var i,o,s,a,l,c,p,f;r=r.map(function(t){var e,n,r;for(n in t){r=t[n];try{t[n]=angular.fromJson(r)}catch(i){e=i}}return t}),s=[];for(i in e)f=e[i],["field","limit","offset","order"].indexOf(i)<0&&(s[i]=f);return r=t.filter(r,s,u),c=null!=e?e.order:void 0,r=t.sort(r,c),l=null!=e?e.offset:void 0,a=null!=e?e.limit:void 0,r=t.paginate(r,l,a),p=null!=e?e.property:void 0,r=t.properties(r,p),o=null!=e?e.field:void 0,r=t.fields(r,o),n(r)})})}}(this)))},r.prototype.filter=function(t,e,n){return t.filter(function(t){var r,i,o,s,u,a,l,c,p,f;for(o in e){switch(f=e[o],["on","true","yes"].indexOf(f)>-1?f=!0:["off","false","no"].indexOf(f)>-1&&(f=!1),c=o.split("__"),i=c[0],l=c[1],l){case"ne":r=t[i]!==f;break;case"lt":r=t[i]<f;break;case"le":r=t[i]<=f;break;case"gt":r=t[i]>f;break;case"ge":r=t[i]>=f;break;default:switch(n){case"buildslaves":if("builderid"===i||"masterid"===i)for(p=t.configured_on,u=0,a=p.length;a>u&&(s=p[u],!(r=s[i]===f));u++);break;case"forceschedulers":r=!0;break;case"masters":r=!0;break;default:r=t[i]===f}}if(!r)return!1}return!0})},r.prototype.sort=function(t,e){var n,r;return n=function(t){var e;return"-"===t[0]&&(t=t.slice(1),e=!0),function(n,r){var i;return e&&(i=[r,n],n=i[0],r=i[1]),n[t]<r[t]?-1:n[t]>r[t]?1:0}},r=t.slice(0),angular.isString(e)?r.sort(n(e)):angular.isArray(e)&&r.sort(function(t,r){var i,o,s,u;for(o=0,s=e.length;s>o;o++)if(u=e[o],i=n(u)(t,r))return i;return 0}),r},r.prototype.paginate=function(t,e,n){var r;return null==e&&(e=0),e>=t.length?[]:(r=null==n||e+n>t.length?t.length:e+n-1,t.slice(e,+r+1||9e9))},r.prototype.properties=function(t,e){return t},r.prototype.fields=function(t,n){var r,i,o,s;if(null==n)return t;for(angular.isArray(n)||(n=[n]),i=0,s=t.length;s>i;i++){r=t[i];for(o in r)e.call(n,o)<0&&delete r[o]}return t},r.prototype.numberOrString=function(t){var e;return null==t&&(t=null),angular.isNumber(t)?t:(e=parseInt(t,10),isNaN(e)?t:e)},r.prototype.processUrl=function(t){var e,r,i,o,s,u,l,c,p,f,h,d,g,b,m,v,y;if(h=t.split("/"),m=h[0],o=h[1],c=3<=h.length?n.call(h,2):[],v=a[m],f={},0===c.length)return o=this.numberOrString(o),angular.isString(o)&&v.identifier&&(f[v.identifier]=o,o=null),[m,f,o];if(p=c.join("/"),s=v.paths.filter(function(t){var e;return e=t.replace(RegExp(a.FIELDTYPES.IDENTIFIER+"\\:\\w+","g"),"[a-zA-Z]+").replace(RegExp(a.FIELDTYPES.NUMBER+"\\:\\w+","g"),"\\d+"),RegExp("^"+e+"$").test(p)}).pop(),null==s)throw new Error("No child path ("+c.join("/")+") found for root ("+m+")");return s=s.split("/"),c.length%2===0&&(i=this.numberOrString(c.pop()),d=s.pop().split(":"),r=d[0],e=d[1]),y=c.pop(),s.pop(),l=this.numberOrString(c.pop()||o),u=(null!=(g=s.pop())?g.split(":").pop():void 0)||a[m].id,e===(null!=(b=a[y])?b.id:void 0)?o=i:(f[u]=l,null!=e&&(f[e]=i),o=null),[y,f,o]},r.prototype.processSpecification=function(t){var e,n,r,i,o;o={};for(r in t)i=t[r],angular.isArray(i.fields)&&(e=i.fields.slice(0),n=e.indexOf(i.id),n>-1?e[n]="&"+e[n]:e.unshift("++id"),o[r]=e.join(","));return o},r}())}return t}(),angular.module("bbData").service("indexedDBService",["$log","$injector","$q","$window","dataUtilsService","DBSTORES","SPECIFICATION",t])}.call(this),function(){var t;t=function(){function t(){}return t.prototype.capitalize=function(t){return t[0].toUpperCase()+t.slice(1).toLowerCase()},t.prototype.type=function(t){var e;return e=this.copyOrSplit(t),e=e.filter(function(t){return"*"!==t}),e.length%2===0&&e.pop(),e.pop()},t.prototype.singularType=function(t){return this.type(t).replace(/s$/,"")},t.prototype.socketPath=function(t){var e,n;return e=this.copyOrSplit(t),n=["*"],e.length%2===1&&n.push("*"),e.concat(n).join("/")},t.prototype.restPath=function(t){var e;return e=this.copyOrSplit(t),e=e.filter(function(t){return"*"!==t}),e.join("/")},t.prototype.endpointPath=function(t){var e;return e=this.copyOrSplit(t),e=e.filter(function(t){return"*"!==t}),e.length%2===0&&e.pop(),e.join("/")},t.prototype.copyOrSplit=function(t){if(angular.isArray(t))return t.slice(0);if(angular.isString(t))return t.split("/");throw new TypeError("Parameter 'arrayOrString' must be a array or a string, not "+typeof t)},t.prototype.unWrap=function(t,e){var n;return n=this.type(e),t[n]},t}(),angular.module("bbData").service("dataUtilsService",[t])}.call(this),function(){var t,e=[].slice;t=function(){function t(t,n,r){var i;return new(i=function(){function i(){}return i.prototype.execute=function(e){return n(function(n){return function(n,r){return t(e).success(function(t){var e,i;try{return e=angular.fromJson(t),n(e)}catch(o){return i=o,r(i)}}).error(function(t){return r(t)})}}(this))},i.prototype.get=function(t,e){var n;return null==e&&(e={}),n={method:"GET",url:this.parse(r,t),params:e,headers:{Accept:"application/json"}},this.execute(n)},i.prototype.post=function(t,e){var n;return null==e&&(e={}),n={method:"POST",url:this.parse(r,t),data:e,headers:{"Content-Type":"application/json"}},this.execute(n)},i.prototype.parse=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],t.join("/").replace(/\/\//,"/")},i}())}return t}(),angular.module("bbData").service("restService",["$http","$q","API",t])}.call(this),function(){var t;t=function(){function t(t,e,n,r){var i;return new(i=function(){function i(){}return i.prototype.queue=[],i.prototype.deferred={},i.prototype.onMessage=null,i.prototype.onClose=null,i.prototype.open=function(){return null==this.socket&&(this.socket=this.getWebSocket()),this.socket.onopen=function(t){return function(){return t.flush()}}(this),this.socket.onmessage=function(e){return function(n){var r,i,o,s,u,a,l,c,p,f;try{return i=angular.fromJson(n.data),t.debug("WS message",i),null!=i._id?(l=[i.msg,i.error,i._id,i.code],n=l[0],s=l[1],u=l[2],r=l[3],200===r?null!=(c=e.deferred[u])?c.resolve(n):void 0:null!=(p=e.deferred[u])?p.reject(s):void 0):(f=[i.k,i.m],a=f[0],n=f[1],"function"==typeof e.onMessage?e.onMessage(a,n):void 0)}catch(h){return o=h,t.error(o)}}}(this),this.socket.onclose=function(t){return function(){return"function"==typeof t.onClose?t.onClose():void 0}}(this)},i.prototype.close=function(){var t;return null!=(t=this.socket)?t.close():void 0},i.prototype.send=function(n){var r,i;return i=this.nextId(),n._id=i,null==(r=this.deferred)[i]&&(r[i]=e.defer()),n=angular.toJson(n),this.socket.readyState===(this.socket.OPEN||1)?(t.debug("WS send",angular.fromJson(n)),this.socket.send(n)):this.queue.push(n),this.deferred[i].promise},i.prototype.flush=function(){var e,n;for(n=[];e=this.queue.shift();)t.debug("WS send",angular.fromJson(e)),n.push(this.socket.send(e));return n},i.prototype.nextId=function(){return null==this.id&&(this.id=0),this.id=this.id<1e3?this.id+1:0,this.id},i.prototype.getUrl=function(){var t,e;return t=n.host(),e=80===n.port()?"":":"+n.port(),"ws://"+t+e+"/ws"},i.prototype.getWebSocket=function(){var t;return t=this.getUrl(),null!=r.ReconnectingWebSocket?new r.ReconnectingWebSocket(t):new r.WebSocket(t)},i}())}return t}(),angular.module("bbData").service("socketService",["$log","$q","$location","$window",t])}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n=[].slice;t=function(){function t(t,r,i,o,s,u,a,l,c){var p;return new(p=function(){function p(){this.closeHandler=e(this.closeHandler,this),this.messageHandler=e(this.messageHandler,this),this.refreshHandler=e(this.refreshHandler,this),this.masterHandler=e(this.masterHandler,this),s.onMessage=this.messageHandler,s.onClose=this.closeHandler,this.initialRoleDeferred=i.defer(),this.initialRole=this.initialRoleDeferred.promise,this.client.on(f.MASTER,this.masterHandler),this.client.on(f.REFRESH,this.refreshHandler),r.onunload=r.onbeforeunload=function(t){return function(e){return t.activatePaths(),null}}(this)}var f,h,d;return f={MASTER:"!sys.master",REFRESH:"!sys.channels.refresh"},d={MASTER:"bb.role.master",SLAVE:"bb.role.slave"},p.prototype._ROLES=d,h={READY:"bb.event.ready",UPDATE:"bb.event.update",NEW:"bb.event.new"},p.prototype.EVENTS=h,p.prototype.client=r.tabex.client(),p.prototype.getSpecification=function(t){return c[t]},p.prototype.masterHandler=function(t){return t.node_id===t.master_id?(this.role=d.MASTER,this.initialRoleDeferred.resolve(),s.open()):(this.role=d.SLAVE,this.initialRoleDeferred.resolve(),s.close())},p.prototype.refreshHandler=function(t){return this.initialRole.then(function(e){return function(){return e.role===d.MASTER?e.masterRefreshHandler(t):void 0}}(this))},p.prototype.debounceTimeout=100,p.prototype.trackedPaths={},p.prototype.consuming={},p.prototype.masterRefreshHandler=function(e){return null!=this.timeoutPromise&&o.cancel(this.timeoutPromise),this.timeoutPromise=o(function(n){return function(){return n.activatePaths().then(function(){var r,i,o,s,u,a,l,c;for(i=e.channels.filter(function(t){return 0!==t.indexOf("!sys.")}),l={},s=0,u=i.length;u>s;s++){r=i[s];try{c=angular.fromJson(r),null==l[a=c.path]&&(l[a]=[]),l[c.path].push(c.query)}catch(p){return o=p,void t.error("channel is not a JSON string",r)}}return n.startConsumingAll(l).then(function(){var t;for(t in n.consuming)t in l||(n.stopConsuming(t),delete n.consuming[t]);return n.trackedPaths=l,n.loadAll(l)})})}}(this),this.debounceTimeout)},p.prototype.messageHandler=function(t,e){var n,r,i,o;return i=t.split("/").slice(-3),o=i[0],r=i[1],n=i[2],n="new"===n?h.NEW:h.UPDATE,l.db[o].put(e).then(function(e){return function(){var r,i,o;o=[];for(r in e.trackedPaths)o.push(RegExp("^"+r.replace(/\*/g,"(\\w+|\\d+)")+"$").test(t)?function(){var t,e,o,s;for(o=this.trackedPaths[r],s=[],t=0,e=o.length;e>t;t++)i=o[t],s.push(this.emit(r,i,n));return s}.call(e):void 0);return o}}(this))},p.prototype.closeHandler=function(){var t;return t=angular.copy(this.trackedPaths),this.trackedPaths={},this.startConsumingAll(t)},p.prototype.loadAll=function(t){var e;return e=l.db,e.paths.toArray().then(function(e){return function(n){var r,i,o,s;s=[];for(r in t)i=t[r],s.push(function(){var t,e,s;for(s=[],t=0,e=i.length;e>t;t++)o=i[t],s.push(this.load(r,o,n));return s}.call(e));return s}}(this))},p.prototype.load=function(e,n,r){return null==r&&(r=[]),i(function(t){return function(i,o){var s,c,p,f,h,d,g,b,m,v,y;for(c=l.db,y={path:e,query:angular.toJson(n)},v=a.type(e),m=t.getSpecification(v),d=0,g=r.length;g>d;d++)if(h=r[d],f=h.path===y.path&&h.query===y.query,p=new Date-new Date(h.lastActive),s=2e3>p||m["static"]===!0,f&&s)return void i();return b=a.restPath(e),u.get(b,n).then(function(t){var e;return e=a.type(b),t=a.unWrap(t,e),c.transaction("rw",c[e],function(){var n,r,i,o,s,u;for(angular.isArray(t)||(t=[t]),s=[],o=0,i=t.length;i>o;o++)n=t[o],s.push(function(){var t;t=[];for(r in n)u=n[r],angular.isObject(n[r])&&(n[r]=angular.toJson(u)),t.push(c[e].put(n));return t}());return s}).then(function(){return c.transaction("rw",c.paths,function(){return c.paths.put(y)}).then(function(){return i()})["catch"](function(t){return o(t)})})["catch"](function(t){return o(t)})},function(t){return o(t)})}}(this)).then(function(t){return function(){return t.emit(e,n,h.READY)}}(this),function(e){return function(e){return t.error(e)}}(this))},p.prototype.activatePaths=function(){var t,e;return e=angular.copy(this.trackedPaths),t=l.db,t.transaction("rw",t.paths,function(n){return function(){var n,r,i,o,s;n=(new Date).toString(),s=[];for(r in e)i=e[r],s.push(function(){var e,s,u;for(u=[],e=0,s=i.length;s>e;e++)o=i[e],u.push(t.paths.where("[path+query]").equals([r,angular.toJson(o)]).modify({lastActive:n}));return u}());return s}}(this))},p.prototype.on=function(){var t,e,r,i,o,s,u;return i=2<=arguments.length?n.call(arguments,0,e=arguments.length-1):(e=0,[]),r=arguments[e++],o=i[0],s=i[1],s=angular.copy(s)||{},u=s.subscribe,delete s.subscribe,u===!1?void this.load(o,s).then(function(){return r(h.READY)}):(t={path:o,query:s},this.client.on(angular.toJson(t),r))},p.prototype.off=function(){var t,e,r,i,o,s;return i=2<=arguments.length?n.call(arguments,0,e=arguments.length-1):(e=0,[]),r=arguments[e++],o=i[0],s=i[1],s=angular.copy(s)||{},delete s.subscribe,t={path:o,query:s},this.client.off(angular.toJson(t),r)},p.prototype.emit=function(){var t,e,r,i,o,s;return i=2<=arguments.length?n.call(arguments,0,e=arguments.length-1):(e=0,[]),r=arguments[e++],o=i[0],s=i[1],t={path:o,query:s||{}},this.client.emit(angular.toJson(t),r,!0)},p.prototype.startConsuming=function(t){return s.send({cmd:"startConsuming",path:t})},p.prototype.stopConsuming=function(t){return s.send({cmd:"stopConsuming",path:t})},p.prototype.startConsumingAll=function(t){var e,n,r,o,s,u,a,l,c,p,f,h,d,g,b,m,v;if(angular.isArray(t))v=t.slice(0);else{if(!angular.isObject(t))throw new Error("Parameter paths is not an object or an array");v=Object.keys(t)}for(d=[],e=r=0,o=v.length;o>r;e=++r)for(f=v[e],m=RegExp("^"+f.replace(/\*/g,"(\\w+|\\d+|\\*)")+"$"),n=l=0,s=v.length;s>l;n=++l)b=v[n],n!==e&&m.test(b)&&d.push(b);for(c=0,u=d.length;u>c;c++)f=d[c],v.splice(v.indexOf(f),1);for(g=[],p=0,a=v.length;a>p;p++)h=v[p],h in this.trackedPaths||(this.consuming[h]=!0,g.push(this.startConsuming(h)));return i.all(g)},p.prototype.mergePaths=function(t,e){var n,r,i,o;o=[];for(n in e)r=e[n],null==t[n]&&(t[n]=[]),o.push(function(){var e,o,s;for(s=[],e=0,o=r.length;o>e;e++)i=r[e],s.push(0===t[n].filter(function(t){return angular.equals(t,i)}).length?t[n].push(i):void 0);return s}());return o},p}())}return t}(),angular.module("bbData").service("tabexService",["$log","$window","$q","$timeout","socketService","restService","dataUtilsService","indexedDBService","SPECIFICATION",t])}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},r={}.hasOwnProperty,i=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=function(){function t(t,r,o,s,u,a,l){var c;return c=function(c){function p(n,i){var o,u;null==i&&(i={}),this.listener=e(this.listener,this),this.getRestPath=function(){return n},this.getQuery=function(){return i},this.getSocketPath=function(){return s.socketPath(n)},this.getType=function(){return s.type(n)},this.getEndpoint=function(){return s.endpointPath(n)},this.getSpecification=function(){return l[this.getType()]},o=r.get("Wrapper"),this.getWrapper=function(){return o},u=t.defer(),this.getReadyDeferred=function(){return u},this.getReadyPromise=function(){return u.promise}}return n(p,c),p.prototype.subscribe=function(){var t;return u.on(this.getSocketPath(),this.getQuery(),this.listener),t=this.getReadyPromise(),t.getArray=function(t){return function(){return t}}(this),t},p.prototype.unsubscribe=function(){return this.forEach(function(t){return null!=t&&"function"==typeof t.unsubscribe?t.unsubscribe():void 0}),u.off(this.getSocketPath(),this.getQuery(),this.listener)},p.prototype.listener=function(t){var e;if(t!==u.EVENTS.READY||0===this.length)return e=angular.copy(this.getQuery()),delete e.subscribe,a.get(this.getRestPath(),e).then(function(e){return function(n){switch(angular.isArray(n)||(n=[n]),t){case u.EVENTS.READY:return e.readyHandler(n);case u.EVENTS.UPDATE:return e.updateHandler(n);case u.EVENTS.NEW:return e.newHandler(n);default:return o.error("Unhandled tabex event",t)}}}(this))},p.prototype.readyHandler=function(t){var e;return this.from(t),null!=(e=this.getReadyDeferred())?e.resolve(this):void 0},p.prototype.newHandler=function(t){var e,n;return e=this.getSpecification().id,n={"new":t.map(function(t){return t[e]}),old:this.map(function(t){return t[e]})},t.forEach(function(t){return function(r){var o;return o=r[e],i.call(n.old,o)<0?t.add(r):void 0}}(this)),this.forEach(function(t){return function(r){var o;return o=r[e],i.call(n["new"],o)<0?t["delete"](r):void 0}}(this))},p.prototype.updateHandler=function(t){var e,n,r,i,o;for(this.newHandler(t),n=this.getSpecification().id,o=[],r=0,i=t.length;i>r;r++)e=t[r],o.push(this.forEach(function(t){return e[n]===t[n]?t.update(e):void 0}));return o},p.prototype.from=function(t){var e,n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(this.add(e));return i},p.prototype.add=function(t){var e,n;return e=this.getWrapper(),n=new e(t,this.getEndpoint()),this.push(n)},p.prototype.clear=function(){var t;for(t=[];this.length>0;)t.push(this.pop());return t},p.prototype["delete"]=function(t){var e;return e=this.indexOf(t),e>-1?this.splice(e,1):void 0},p}(Array)}return t}(),angular.module("bbData").factory("Collection",["$q","$injector","$log","dataUtilsService","tabexService","indexedDBService","SPECIFICATION",t])}.call(this),function(){var t,e=[].slice;t=function(){function t(t,n,r,i,o){var s;return s=function(){function t(t,e){var n;if(!angular.isString(e))throw new TypeError("Parameter 'endpoint' must be a string, not "+typeof e);this.getEndpoint=function(){return e},this.update(t),n=Object.keys(o),this.constructor.generateFunctions(n)}return t.prototype.update=function(t){return angular.merge(this,t)},t.prototype.get=function(){var t,r,i,s,u,a,l,c,p,f,h,d,g,b,m,v,y,S;if(t=1<=arguments.length?e.call(arguments,0):[],b=this.getEndpoint().split("/"),y=b[0],a=b[1],d=3<=b.length?e.call(b,2):[],f=2<=t.length?e.call(t,0,u=t.length-1):(u=0,[]),c=t[u++],g=angular.isObject(c)?d.concat("*",f).join("/"):d.concat("*",t).join("/"),0===d.length)return n.get.apply(n,[this.getEndpoint(),this.getId()].concat(e.call(t)));for(S=o[y],p=S.paths.filter(function(t){var e;return e=t.replace(/\w+\:\w+/g,"\\*"),RegExp("^"+e+"$").test(g)}).pop(),null==p&&(h=this.getId()),m=p.split("/"),l=m.length-1;l>=0;l+=-1)r=m[l],r.indexOf(":")>-1&&(v=r.split(":"),s=v[0],i=v[1],h=this[i]);return n.get.apply(n,[this.getEndpoint(),h].concat(e.call(t)))},t.generateFunctions=function(t){return t.forEach(function(t){return function(n){var i;return i=r.capitalize(n),t.prototype["load"+i]=function(){var t,r;return t=1<=arguments.length?e.call(arguments,0):[],r=this.get.apply(this,[n].concat(e.call(t))),this[n]=r.getArray(),r}}}(this))},t.prototype.getId=function(){return this[this.classId()]},t.prototype.getIdentifier=function(){return this[this.classIdentifier()]},t.prototype.classId=function(){return o[r.type(this.getEndpoint())].id},t.prototype.classIdentifier=function(){return o[r.type(this.getEndpoint())].identifier},t.prototype.unsubscribe=function(){var t,e,n;n=[];for(t in this)e=this[t],n.push(null!=e&&"function"==typeof e.unsubscribe?e.unsubscribe():void 0);return n},t}()}return t}(),angular.module("bbData").factory("Wrapper",["$log","dataService","dataUtilsService","tabexService","SPECIFICATION",t])}.call(this);